shadow$provide.module$node_modules$$pixi$prepare$dist$cjs$prepare=function(global,require,module,exports){function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}function findMultipleBaseTextures(item,queue){var result=!1;if(item&&item._textures&&item._textures.length)for(var i=0;i<item._textures.length;i++)if(item._textures[i]instanceof core.Texture){var baseTexture=item._textures[i].baseTexture;-1===queue.indexOf(baseTexture)&&
(queue.push(baseTexture),result=!0)}return result}function findBaseTexture(item,queue){return item.baseTexture instanceof core.BaseTexture?(item=item.baseTexture,-1===queue.indexOf(item)&&queue.push(item),!0):!1}function findTexture(item,queue){return item._texture&&item._texture instanceof core.Texture?(item=item._texture.baseTexture,-1===queue.indexOf(item)&&queue.push(item),!0):!1}function drawText(_helper,item){return item instanceof text.Text?(item.updateText(!0),!0):!1}function calculateTextStyle(_helper,
item){return item instanceof text.TextStyle?(_helper=item.toFontString(),text.TextMetrics.measureFont(_helper),!0):!1}function findText(item,queue){return item instanceof text.Text?(-1===queue.indexOf(item.style)&&queue.push(item.style),-1===queue.indexOf(item)&&queue.push(item),item=item._texture.baseTexture,-1===queue.indexOf(item)&&queue.push(item),!0):!1}function findTextStyle(item,queue){return item instanceof text.TextStyle?(-1===queue.indexOf(item)&&queue.push(item),!0):!1}function uploadBaseTextures(renderer,
item){return item instanceof core.BaseTexture?(item._glTextures[renderer.CONTEXT_UID]||renderer.texture.bind(item),!0):!1}function uploadGraphics(renderer,item){if(!(item instanceof graphics.Graphics))return!1;var geometry=item.geometry;item.finishPoly();geometry.updateBatches();for(var batches=geometry.batches,i=0;i<batches.length;i++){var texture=batches[i].style.texture;texture&&uploadBaseTextures(renderer,texture.baseTexture)}geometry.batchable||renderer.geometry.bind(geometry,item._resolveDirectShader(renderer));
return!0}function findGraphics(item,queue){return item instanceof graphics.Graphics?(queue.push(item),!0):!1}Object.defineProperty(exports,"__esModule",{value:!0});var settings=require("module$node_modules$$pixi$settings$dist$cjs$settings"),core=require("module$node_modules$$pixi$core$dist$cjs$core"),graphics=require("module$node_modules$$pixi$graphics$dist$cjs$graphics"),ticker=require("module$node_modules$$pixi$ticker$dist$cjs$ticker"),display=require("module$node_modules$$pixi$display$dist$cjs$display"),
text=require("module$node_modules$$pixi$text$dist$cjs$text");settings.settings.UPLOADS_PER_FRAME=4;var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,b$jscomp$0)},CountLimiter=function(){function CountLimiter(maxItemsPerFrame){this.maxItemsPerFrame=maxItemsPerFrame;this.itemsLeft=0}CountLimiter.prototype.beginFrame=
function(){this.itemsLeft=this.maxItemsPerFrame};CountLimiter.prototype.allowedToUpload=function(){return 0<this.itemsLeft--};return CountLimiter}();global=function(){function BasePrepare(renderer){var _this=this;this.limiter=new CountLimiter(settings.settings.UPLOADS_PER_FRAME);this.renderer=renderer;this.uploadHookHelper=null;this.queue=[];this.addHooks=[];this.uploadHooks=[];this.completes=[];this.ticking=!1;this.delayedTick=function(){_this.queue&&_this.prepareItems()};this.registerFindHook(findText);
this.registerFindHook(findTextStyle);this.registerFindHook(findMultipleBaseTextures);this.registerFindHook(findBaseTexture);this.registerFindHook(findTexture);this.registerUploadHook(drawText);this.registerUploadHook(calculateTextStyle)}BasePrepare.prototype.upload=function(item,done){"function"===typeof item&&(done=item,item=null);item&&this.add(item);this.queue.length?(done&&this.completes.push(done),this.ticking||(this.ticking=!0,ticker.Ticker.system.addOnce(this.tick,this,ticker.UPDATE_PRIORITY.UTILITY))):
done&&done()};BasePrepare.prototype.tick=function(){setTimeout(this.delayedTick,0)};BasePrepare.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var item=this.queue[0],uploaded=!1;if(item&&!item._destroyed)for(var i=0,len=this.uploadHooks.length;i<len;i++)if(this.uploadHooks[i](this.uploadHookHelper,item)){this.queue.shift();uploaded=!0;break}uploaded||this.queue.shift()}if(this.queue.length)ticker.Ticker.system.addOnce(this.tick,
this,ticker.UPDATE_PRIORITY.UTILITY);else for(this.ticking=!1,item=this.completes.slice(0),i=this.completes.length=0,len=item.length;i<len;i++)item[i]()};BasePrepare.prototype.registerFindHook=function(addHook){addHook&&this.addHooks.push(addHook);return this};BasePrepare.prototype.registerUploadHook=function(uploadHook){uploadHook&&this.uploadHooks.push(uploadHook);return this};BasePrepare.prototype.add=function(item){for(var i=0,len=this.addHooks.length;i<len&&!this.addHooks[i](item,this.queue);i++);
if(item instanceof display.Container)for(i=item.children.length-1;0<=i;i--)this.add(item.children[i]);return this};BasePrepare.prototype.destroy=function(){this.ticking&&ticker.Ticker.system.remove(this.tick,this);this.ticking=!1;this.uploadHookHelper=this.limiter=this.queue=this.completes=this.renderer=this.uploadHooks=this.addHooks=null};return BasePrepare}();require=function(_super){function Prepare(renderer){renderer=_super.call(this,renderer)||this;renderer.uploadHookHelper=renderer.renderer;
renderer.registerFindHook(findGraphics);renderer.registerUploadHook(uploadBaseTextures);renderer.registerUploadHook(uploadGraphics);return renderer}__extends(Prepare,_super);return Prepare}(global);module=function(){function TimeLimiter(maxMilliseconds){this.maxMilliseconds=maxMilliseconds;this.frameStart=0}TimeLimiter.prototype.beginFrame=function(){this.frameStart=Date.now()};TimeLimiter.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds};return TimeLimiter}();
exports.BasePrepare=global;exports.CountLimiter=CountLimiter;exports.Prepare=require;exports.TimeLimiter=module}
//# sourceMappingURL=module$node_modules$$pixi$prepare$dist$cjs$prepare.js.map
