{"version":3,"sources":["ellah/geometry.cljs"],"mappings":"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","names":["ellah.geometry/PI","Math/PI","ellah.geometry/TAU","ellah.geometry/origin","ellah.geometry/unit","ellah.geometry/unit-square","var_args","args__4742__auto__","len__4736__auto__","i__4737__auto__","argseq__4743__auto__","cljs.core/IndexedSeq","ellah.geometry/add-points","seq75732","self__4724__auto__","cljs.core/seq","points","cljs.core.apply","cljs.core/+","cljs.core.mapv","ellah.geometry/multiply-points","seq75739","cljs.core/*","ellah.geometry/scale-point","a","s","ellah.geometry/subtract-points","b","ellah.geometry.add_points","p__75743","vec__75744","cljs.core.nth","ellah.geometry/in-rect?","pos","size","point","off","p__75753","vec__75754","ellah.geometry/rect-within","aspect-ratio","rect-width","x__4217__auto__","y__4218__auto__","rect-height","rect-size","rect-pos","p__75757","vec__75758","ellah.geometry/rect-around","x__4214__auto__","y__4215__auto__","ellah.geometry/point-square-magnitude","p","Math/pow","ellah.geometry/point-magnitude","Math/sqrt","ellah.geometry/normalize-point","mag","ellah.geometry/tween-points","p1","p2","t","ellah.geometry/average-point","cljs.core/count","ellah.geometry/angle-point","angle","Math/cos","Math/sin","ellah.geometry/point-angle","Math/atan2","ellah.geometry/reflect-point","map__75761","cljs.core/PROTOCOL_SENTINEL","cljs.core/hash-map","cljs.core.get","x","y","double-angle","cljs.core/mod","c","ellah.geometry/normal-point","ellah.geometry/polygon","p__75767","vec__75770","seq75763","G__75764","cljs.core/first","cljs.core/next","self__4723__auto__","sides","rotation","i","cljs.core.range","ellah.geometry/map-point","from-pos","from-size","to-pos","to-size","cljs.core.reduce","dim","cljs.core.assoc","from-min","from-max","to-min","to-max","ellah.util.map_range","ellah.geometry/adjust-aspect-ratio","ar","ellah.geometry.multiply_points","cljs.core/last","ellah.geometry/in-circle?","circle"],"sourcesContent":["(ns ellah.geometry\n  (:require [ellah.util :as u]))\n\n(def PI Math/PI)\n(def TAU (* 2 PI))\n\n(def origin {:x 0 :y 0})\n(def unit {:x 1 :y 1})\n\n(def unit-square [origin unit])\n\n(defn add-points [& points]\n  {:x (apply + (mapv :x points))\n   :y (apply + (mapv :y points))})\n\n(defn multiply-points [& points]\n  {:x (apply * (mapv :x points))\n   :y (apply * (mapv :y points))})\n\n(defn scale-point [a s]\n  {:x (* (:x a) s)\n   :y (* (:y a) s)})\n\n(defn subtract-points [a b]\n  (add-points a (scale-point b -1)))\n\n(defn in-rect? [[pos size] point]\n  (let [off (subtract-points point pos)]\n    (and (<= 0 (:x off) (:x size))\n         (<= 0 (:y off) (:y size)))))\n\n(defn rect-within [[pos size] aspect-ratio]\n  (let [rect-width (min (:x size) (* aspect-ratio (:y size)))\n        rect-height (/ rect-width aspect-ratio)\n        rect-size {:x rect-width :y rect-height}\n        rect-pos (add-points pos\n                             (scale-point (subtract-points size rect-size)\n                                          0.5))]\n    [rect-pos rect-size]))\n\n(defn rect-around [[pos size] aspect-ratio]\n  (let [rect-width (max (:x size) (* aspect-ratio (:y size)))\n        rect-height (/ rect-width aspect-ratio)\n        rect-size {:x rect-width\n                   :y rect-height}\n        rect-pos (subtract-points pos\n                                  (scale-point (subtract-points rect-size size)\n                                               0.5))]\n    [rect-pos rect-size]))\n\n(defn point-square-magnitude [p]\n  (+ (Math/pow (:x p) 2)\n     (Math/pow (:y p) 2)))\n\n(defn point-magnitude [p]\n  (Math/sqrt (point-square-magnitude p)))\n\n(defn normalize-point [p]\n  (let [mag (point-magnitude p)]\n    (if (zero? mag)\n      p\n      (scale-point p\n                   (/ 1 mag)))))\n\n(defn tween-points [p1 p2 t]\n  (add-points (scale-point p2 t)\n              (scale-point p1 (- 1 t))))\n\n(defn average-point [points]\n  (scale-point (add-points points)\n               (/ 1 (count points))))\n\n(defn angle-point [angle]\n  {:x (Math/cos angle)\n   :y (Math/sin angle)})\n\n(defn point-angle [point]\n  (Math/atan2 (:x point) (:y point)))\n\n(defn reflect-point [point angle]\n  (let [{:keys [x y]} point\n        double-angle (* 2 (mod angle (* 2 Math/PI)))\n        c (Math/cos double-angle)\n        s (Math/sin double-angle)]\n    {:x (- (* s y) (* c x))\n     :y (+ (* s x) (* c y))}))\n\n(defn normal-point [point]\n  {:x (- (:y point))\n   :y (:x point)})\n\n(defn polygon [sides & [rotation]]\n  (mapv (fn [i]\n          (let [angle (+ rotation (/ (* TAU i) sides))]\n            {:x (Math/cos angle)\n             :y (Math/sin angle)}))\n        (range sides)))\n\n(defn map-point [from-pos from-size to-pos to-size point]\n  (reduce (fn [pos dim]\n            (assoc pos\n                   dim\n                   (let [from-min (dim from-pos)\n                         from-max (+ from-min (dim from-size))\n                         to-min (dim to-pos)\n                         to-max (+ to-min (dim to-size))]\n                     (u/map-range from-min from-max to-min to-max (dim point)))))\n          {}\n          [:x :y]))\n\n(defn adjust-aspect-ratio [point ar]\n  (multiply-points point\n                   (last (rect-within unit-square ar))))\n\n(defn in-circle? [circle pos]\n  (< (point-square-magnitude (subtract-points circle pos))\n     (Math/pow (:radius circle) 2)))"]}