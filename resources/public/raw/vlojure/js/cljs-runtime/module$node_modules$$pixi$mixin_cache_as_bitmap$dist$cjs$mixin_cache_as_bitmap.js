shadow$provide.module$node_modules$$pixi$mixin_cache_as_bitmap$dist$cjs$mixin_cache_as_bitmap=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var core=require("module$node_modules$$pixi$core$dist$cjs$core"),sprite=require("module$node_modules$$pixi$sprite$dist$cjs$sprite");global=require("module$node_modules$$pixi$display$dist$cjs$display");module=require("module$node_modules$$pixi$math$dist$cjs$math");var utils=require("module$node_modules$$pixi$utils$dist$cjs$utils"),
settings=require("module$node_modules$$pixi$settings$dist$cjs$settings"),_tempMatrix=new module.Matrix;global.DisplayObject.prototype._cacheAsBitmap=!1;global.DisplayObject.prototype._cacheData=null;global.DisplayObject.prototype._cacheAsBitmapResolution=null;var CacheData=function(){return function(){this.sprite=this.originalContainsPoint=this.originalFilterArea=this.originalMask=this.originalDestroy=this.originalUpdateTransform=this.originalGetLocalBounds=this.originalCalculateBounds=this.originalRenderCanvas=
this.originalRender=this.textureCacheId=null}}();Object.defineProperties(global.DisplayObject.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(resolution){resolution!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=resolution,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(value){this._cacheAsBitmap!==value&&((this._cacheAsBitmap=value)?(this._cacheData||
(this._cacheData=new CacheData),value=this._cacheData,value.originalRender=this.render,value.originalRenderCanvas=this.renderCanvas,value.originalUpdateTransform=this.updateTransform,value.originalCalculateBounds=this.calculateBounds,value.originalGetLocalBounds=this.getLocalBounds,value.originalDestroy=this.destroy,value.originalContainsPoint=this.containsPoint,value.originalMask=this._mask,value.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,
this.destroy=this._cacheAsBitmapDestroy):(value=this._cacheData,value.sprite&&this._destroyCachedDisplayObject(),this.render=value.originalRender,this.renderCanvas=value.originalRenderCanvas,this.calculateBounds=value.originalCalculateBounds,this.getLocalBounds=value.originalGetLocalBounds,this.destroy=value.originalDestroy,this.updateTransform=value.originalUpdateTransform,this.containsPoint=value.originalContainsPoint,this._mask=value.originalMask,this.filterArea=value.originalFilterArea))}}});
global.DisplayObject.prototype._renderCached=function(renderer){!this.visible||0>=this.worldAlpha||!this.renderable||(this._initCachedDisplayObject(renderer),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(renderer))};global.DisplayObject.prototype._initCachedDisplayObject=function(renderer){if(!this._cacheData||!this._cacheData.sprite){var cacheAlpha=this.alpha;this.alpha=1;renderer.batch.flush();var bounds=
this.getLocalBounds(null,!0).clone();this.filters&&bounds.pad(this.filters[0].padding);bounds.ceil(settings.settings.RESOLUTION);var cachedRenderTexture=renderer.renderTexture.current,cachedSourceFrame=renderer.renderTexture.sourceFrame.clone(),cachedDestinationFrame=renderer.renderTexture.destinationFrame.clone(),cachedProjectionTransform=renderer.projection.transform,renderTexture=core.RenderTexture.create({width:bounds.width,height:bounds.height,resolution:this.cacheAsBitmapResolution||renderer.resolution}),
textureCacheId="cacheAsBitmap_"+utils.uid();this._cacheData.textureCacheId=textureCacheId;core.BaseTexture.addToCache(renderTexture.baseTexture,textureCacheId);core.Texture.addToCache(renderTexture,textureCacheId);textureCacheId=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-bounds.x,-bounds.y);this.render=this._cacheData.originalRender;renderer.render(this,{renderTexture:renderTexture,clear:!0,transform:textureCacheId,skipUpdateTransform:!1});renderer.projection.transform=
cachedProjectionTransform;renderer.renderTexture.bind(cachedRenderTexture,cachedSourceFrame,cachedDestinationFrame);this.render=this._renderCached;this.updateTransform=this.displayObjectUpdateTransform;this.calculateBounds=this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this.filterArea=this._mask=null;this.alpha=cacheAlpha;renderer=new sprite.Sprite(renderTexture);renderer.transform.worldTransform=this.transform.worldTransform;renderer.anchor.x=-(bounds.x/bounds.width);
renderer.anchor.y=-(bounds.y/bounds.height);renderer.alpha=cacheAlpha;renderer._bounds=this._bounds;this._cacheData.sprite=renderer;this.transform._parentID=-1;this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null));this.containsPoint=renderer.containsPoint.bind(renderer)}};global.DisplayObject.prototype._renderCachedCanvas=function(renderer){!this.visible||0>=this.worldAlpha||!this.renderable||(this._initCachedDisplayObjectCanvas(renderer),
this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(renderer))};global.DisplayObject.prototype._initCachedDisplayObjectCanvas=function(renderer){if(!this._cacheData||!this._cacheData.sprite){var bounds=this.getLocalBounds(null,!0),cacheAlpha=this.alpha;this.alpha=1;var cachedRenderTarget=renderer.context,cachedProjectionTransform=renderer._projTransform;bounds.ceil(settings.settings.RESOLUTION);var renderTexture=core.RenderTexture.create({width:bounds.width,height:bounds.height}),
textureCacheId="cacheAsBitmap_"+utils.uid();this._cacheData.textureCacheId=textureCacheId;core.BaseTexture.addToCache(renderTexture.baseTexture,textureCacheId);core.Texture.addToCache(renderTexture,textureCacheId);this.transform.localTransform.copyTo(_tempMatrix);_tempMatrix.invert();_tempMatrix.tx-=bounds.x;_tempMatrix.ty-=bounds.y;this.renderCanvas=this._cacheData.originalRenderCanvas;renderer.render(this,{renderTexture:renderTexture,clear:!0,transform:_tempMatrix,skipUpdateTransform:!1});renderer.context=
cachedRenderTarget;renderer._projTransform=cachedProjectionTransform;this.renderCanvas=this._renderCachedCanvas;this.updateTransform=this.displayObjectUpdateTransform;this.calculateBounds=this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this.filterArea=this._mask=null;this.alpha=cacheAlpha;cachedRenderTarget=new sprite.Sprite(renderTexture);cachedRenderTarget.transform.worldTransform=this.transform.worldTransform;cachedRenderTarget.anchor.x=-(bounds.x/bounds.width);cachedRenderTarget.anchor.y=
-(bounds.y/bounds.height);cachedRenderTarget.alpha=cacheAlpha;cachedRenderTarget._bounds=this._bounds;this._cacheData.sprite=cachedRenderTarget;this.transform._parentID=-1;this.parent?this.updateTransform():(this.parent=renderer._tempDisplayObjectParent,this.updateTransform(),this.parent=null);this.containsPoint=cachedRenderTarget.containsPoint.bind(cachedRenderTarget)}};global.DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear();this._cacheData.sprite.transform._worldID=
this.transform._worldID;this._cacheData.sprite._calculateBounds();this._bounds.updateID=this._boundsID};global.DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};global.DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0);this._cacheData.sprite=null;core.BaseTexture.removeFromCache(this._cacheData.textureCacheId);core.Texture.removeFromCache(this._cacheData.textureCacheId);this._cacheData.textureCacheId=
null};global.DisplayObject.prototype._cacheAsBitmapDestroy=function(options){this.cacheAsBitmap=!1;this.destroy(options)};exports.CacheData=CacheData}
//# sourceMappingURL=module$node_modules$$pixi$mixin_cache_as_bitmap$dist$cjs$mixin_cache_as_bitmap.js.map
